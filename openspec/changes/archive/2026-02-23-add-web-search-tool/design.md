# è®¾è®¡ï¼šadd-web-search-tool

> ğŸ“š **çŸ¥è¯†ä¸Šä¸‹æ–‡**ï¼šè¿™æ˜¯æ–°é¢†åŸŸçš„åŠŸèƒ½å¼€å‘ã€‚åœ¨å®ç°è¿‡ç¨‹ä¸­å¦‚é‡åˆ°é—®é¢˜ï¼Œè¯·åˆ›å»º `fix.md` æ–‡æ¡£æ¥æ„å»ºçŸ¥è¯†åº“ã€‚

## ä¸Šä¸‹æ–‡

### å½“å‰çŠ¶æ€

MSA (My Stock Agent) ç›®å‰å…·å¤‡ä»¥ä¸‹èƒ½åŠ›ï¼š
- è‚¡ç¥¨ä»£ç æŸ¥è¯¢ï¼ˆ`get_stock_company_code`ï¼‰
- è‚¡ç¥¨ K çº¿æ•°æ®è·å–ï¼ˆ`get_stock_k`ï¼‰
- å…¬å¸åŸºæœ¬ä¿¡æ¯æŸ¥è¯¢ï¼ˆ`get_company_info`ï¼‰
- åŸºäº React Agent æ¡†æ¶çš„å·¥å…·è°ƒç”¨ç³»ç»Ÿ
- ä½¿ç”¨ Eino æ¡†æ¶çš„ LLM é›†æˆ

### çº¦æŸæ¡ä»¶

- **å·¥å…·æ¡†æ¶**ï¼šå¿…é¡»å®ç° `MsaTool` æ¥å£ï¼Œä¸ç°æœ‰å·¥å…·æ³¨å†Œæœºåˆ¶å…¼å®¹
- **æ€§èƒ½è¦æ±‚**ï¼šæœç´¢å“åº”æ—¶é—´ < 5 ç§’ï¼Œé¡µé¢æŠ“å– < 8 ç§’
- **èµ„æºé™åˆ¶**ï¼šå†…å­˜å ç”¨å¢åŠ æ§åˆ¶åœ¨ 100MB ä»¥å†…
- **ç”¨æˆ·ç¯å¢ƒ**ï¼šæ— æ³•ä¿è¯ç”¨æˆ·å·²å®‰è£… Chromeï¼Œéœ€è¦æä¾›å‹å¥½çš„é”™è¯¯æç¤º
- **åçˆ¬è™«**ï¼šGoogle çš„åçˆ¬è™«æœºåˆ¶è¾ƒå¼ºï¼Œéœ€è¦åšå¥½åº”å¯¹ç­–ç•¥

### åˆ©ç›Šç›¸å…³è€…

- **ç»ˆç«¯ç”¨æˆ·**ï¼šéœ€è¦è·å–å®æ—¶å¸‚åœºä¿¡æ¯è¿›è¡Œè‚¡ç¥¨åˆ†æ
- **å¼€å‘è€…**ï¼šéœ€è¦æ˜“äºæ‰©å±•çš„æ¶æ„ï¼Œä¾¿äºæ·»åŠ æ–°çš„æœç´¢å¼•æ“å’Œæå–å™¨
- **Agent**ï¼šéœ€è¦ç»“æ„åŒ–çš„æ•°æ®æ ¼å¼ä»¥ä¾¿ç†è§£å’Œå¤„ç†

---

## ç›®æ ‡ / éç›®æ ‡

**ç›®æ ‡ï¼š**

1. ä¸º MSA æ·»åŠ äº’è”ç½‘æœç´¢èƒ½åŠ›ï¼Œä½¿ Agent èƒ½å¤Ÿè·å–å®æ—¶ç½‘ç»œä¿¡æ¯
2. å®ç°ç½‘é¡µå†…å®¹æŠ“å–åŠŸèƒ½ï¼Œæä¾›è¯¦ç»†çš„é¡µé¢æ­£æ–‡
3. è®¾è®¡å¯æ‰©å±•çš„æ¶æ„ï¼Œä¾¿äºæœªæ¥æ·»åŠ å‚ç›´é¢†åŸŸä¼˜åŒ–
4. ä¿æŒä¸ç°æœ‰å·¥å…·ç³»ç»Ÿçš„å…¼å®¹æ€§
5. æä¾›å‹å¥½çš„é”™è¯¯å¤„ç†å’Œç”¨æˆ·åé¦ˆ

**éç›®æ ‡ï¼š**

- ~~è´¢ç»æ–°é—»ä¸“ç”¨æå–å™¨~~ï¼ˆPhase 2 æ ¹æ®æ•°æ®æ·»åŠ ï¼‰
- ~~æœç´¢ç»“æœæ™ºèƒ½é‡æ’åº~~ï¼ˆPhase 2 è€ƒè™‘ï¼‰
- ~~ç»“æœç¼“å­˜æœºåˆ¶~~ï¼ˆä¿æŒç®€å•ï¼Œåç»­ä¼˜åŒ–ï¼‰
- ~~å¤šæœç´¢å¼•æ“å¹¶è¡Œ~~ï¼ˆåªå®ç° Googleï¼Œå…¶ä»–ç•™å¾…æ‰©å±•ï¼‰
- ~~å¤æ‚çš„å†…å®¹åˆ†é¡µ~~ï¼ˆåªæä¾›é•¿åº¦é™åˆ¶å’Œ has_more æ ‡è¯†ï¼‰

---

## æ¨èæ¨¡å¼

è¿™æ˜¯æ–°é¢†åŸŸçš„åŠŸèƒ½å¼€å‘ï¼ŒçŸ¥è¯†åº“ä¸­æš‚æ— ç›¸å…³æ¨¡å¼ã€‚åœ¨å®ç°è¿‡ç¨‹ä¸­æ€»ç»“çš„æ¨¡å¼å°†è®°å½•åˆ° `fix.md` ä¸­ã€‚

### æ¥å£æŠ½è±¡æ¨¡å¼

è™½ç„¶çŸ¥è¯†åº“ä¸­æ²¡æœ‰è®°å½•ï¼Œä½†åŸºäºè‰¯å¥½å®è·µï¼Œæˆ‘ä»¬æ¨èä½¿ç”¨æ¥å£æŠ½è±¡ï¼š

**æè¿°ï¼š**
å®šä¹‰æ¸…æ™°çš„æ¥å£ï¼ˆ`SearchEngine`ã€`Extractor`ã€`Browser`ï¼‰ï¼Œä½¿å®ç°ä¸ä½¿ç”¨æ–¹è§£è€¦ã€‚

**é€‚ç”¨åœºæ™¯ï¼š**
- éœ€è¦æ”¯æŒå¤šç§å®ç°ï¼ˆä¸åŒæœç´¢å¼•æ“ã€ä¸åŒæå–ç­–ç•¥ï¼‰
- æœªæ¥å¯èƒ½æ›¿æ¢åº•å±‚å®ç°ï¼ˆå¦‚ä» chromedp åˆ‡æ¢åˆ° playwrightï¼‰
- éœ€è¦å•å…ƒæµ‹è¯•å’Œ mock

**å®ç°åŸåˆ™ï¼š**
- æ¥å£å®šä¹‰è¡Œä¸ºå¥‘çº¦ï¼Œä¸æš´éœ²å®ç°ç»†èŠ‚
- ä½¿ç”¨ä¾èµ–æ³¨å…¥ï¼Œè€Œéç¡¬ç¼–ç å…·ä½“å®ç°
- æä¾›é»˜è®¤å®ç°ï¼Œä½†ä¸å¼ºåˆ¶ä½¿ç”¨

---

## é¿å…çš„åæ¨¡å¼

è¿™æ˜¯æ–°é¢†åŸŸçš„åŠŸèƒ½å¼€å‘ï¼ŒçŸ¥è¯†åº“ä¸­æš‚æ— ç›¸å…³åæ¨¡å¼ã€‚

### éœ€è¦é¿å…çš„å¸¸è§é—®é¢˜

åŸºäºæ¢ç´¢é˜¶æ®µçš„è®¨è®ºï¼Œæˆ‘ä»¬éœ€è¦é¿å…ä»¥ä¸‹åæ¨¡å¼ï¼š

#### åæ¨¡å¼ 1ï¼šç´§è€¦åˆçš„æœç´¢å¼•æ“å®ç°

**é—®é¢˜æ‰€åœ¨ï¼š**
å¦‚æœå°† Google æœç´¢çš„å…·ä½“å®ç°ç›´æ¥å†™åœ¨å·¥å…·å±‚ä»£ç ä¸­ï¼Œæœªæ¥æ·»åŠ  Bing æˆ–ç™¾åº¦æ—¶éœ€è¦ä¿®æ”¹å·¥å…·ä»£ç ã€‚

**å½±å“ï¼š**
- ä»£ç é‡å¤ï¼ˆå¤šä¸ªæœç´¢å¼•æ“çš„è§£æé€»è¾‘æ··æ‚åœ¨ä¸€èµ·ï¼‰
- éš¾ä»¥æµ‹è¯•ï¼ˆæ— æ³• mock æœç´¢å¼•æ“ï¼‰
- è¿åå¼€é—­åŸåˆ™ï¼ˆå¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å°é—­ï¼‰

**åº”è¯¥è¿™æ ·åšï¼š**
```go
// å®šä¹‰æ¥å£
type SearchEngine interface {
    Search(query string, numResults int) ([]SearchResultItem, error)
}

// å·¥å…·å±‚ä½¿ç”¨æ¥å£
type SearchTool struct {
    engine SearchEngine  // ä¾èµ–æŠ½è±¡ï¼Œè€Œéå…·ä½“å®ç°
}

// Google å®ç°
type GoogleSearchEngine struct {
    browser Browser
}

func (g *GoogleSearchEngine) Search(query string, numResults int) ([]SearchResultItem, error) {
    // Google ç‰¹å®šçš„å®ç°
}
```

#### åæ¨¡å¼ 2ï¼šæµè§ˆå™¨å®ä¾‹é¢‘ç¹åˆ›å»ºé”€æ¯

**é—®é¢˜æ‰€åœ¨ï¼š**
æ¯æ¬¡æœç´¢éƒ½åˆ›å»ºæ–°çš„ Chrome å®ä¾‹ï¼Œç”¨å®Œç«‹å³é”€æ¯ã€‚

**å½±å“ï¼š**
- é¦–æ¬¡æœç´¢å¾ˆæ…¢ï¼ˆå¯åŠ¨ Chrome éœ€è¦ 1-3 ç§’ï¼‰
- èµ„æºæµªè´¹ï¼ˆé¢‘ç¹åˆ›å»ºå’Œé”€æ¯è¿›ç¨‹ï¼‰
- å¯èƒ½è§¦å‘æµè§ˆå™¨çš„åçˆ¬è™«æ£€æµ‹

**åº”è¯¥è¿™æ ·åšï¼š**
```go
// ä½¿ç”¨å•ä¾‹æ¨¡å¼ç®¡ç†æµè§ˆå™¨
type BrowserManager struct {
    ctx    context.Context
    cancel context.CancelFunc
    once   sync.Once
}

func (b *BrowserManager) GetContext() (context.Context, error) {
    var initErr error
    b.once.Do(func() {
        b.ctx, b.cancel = chromedp.NewContext(context.Background())
        initErr = b.ctx.Err()
    })
    return b.ctx, initErr
}

func (b *BrowserManager) Close() error {
    if b.cancel != nil {
        b.cancel()
    }
    return chromedp.Cancel(b.ctx)
}
```

#### åæ¨¡å¼ 3ï¼šæ— é™é‡è¯•æˆ–é˜»å¡

**é—®é¢˜æ‰€åœ¨ï¼š**
é‡åˆ°ç½‘ç»œé—®é¢˜æˆ–åçˆ¬è™«æ—¶æ— é™é‡è¯•ï¼Œæˆ–é•¿æ—¶é—´é˜»å¡ç­‰å¾…ã€‚

**å½±å“ï¼š**
- Agent æ— å“åº”ï¼Œç”¨æˆ·ä½“éªŒå·®
- å¯èƒ½è§¦å‘ IP å°ç¦
- èµ„æºæ³„æ¼

**åº”è¯¥è¿™æ ·åšï¼š**
```go
const (
    maxRetries    = 2
    retryDelay    = time.Second
    requestTimeout = 5 * time.Second
)

func withRetry(fn func() error) error {
    var lastErr error
    for i := 0; i < maxRetries; i++ {
        ctx, cancel := context.WithTimeout(context.Background(), requestTimeout)
        err := fn()
        cancel()

        if err == nil {
            return nil
        }

        // è¯†åˆ«ä¸åº”é‡è¯•çš„é”™è¯¯
        if isPermanentError(err) {
            return err
        }

        lastErr = err
        time.Sleep(retryDelay)
    }
    return fmt.Errorf("after %d retries: %w", maxRetries, lastErr)
}
```

---

## è®¾è®¡å†³ç­–

### å†³ç­– 1ï¼šä½¿ç”¨ chromedp è€Œéçº¯ HTTP å®¢æˆ·ç«¯

**é€‰æ‹©ï¼š** chromedpï¼ˆChrome DevTools Protocol å®¢æˆ·ç«¯ï¼‰

**ç†ç”±ï¼š**
- âœ… æ”¯æŒ JavaScript æ¸²æŸ“ï¼ˆç°ä»£ç½‘ç«™æ™®éä½¿ç”¨ï¼‰
- âœ… èƒ½å¤Ÿå¤„ç†å¤æ‚çš„åçˆ¬è™«æœºåˆ¶
- âœ… å¯ä»¥æ¨¡æ‹ŸçœŸå®ç”¨æˆ·è¡Œä¸º
- âœ… æ´»è·ƒçš„ç¤¾åŒºå’Œç»´æŠ¤

**æƒè¡¡ï¼š**
- âŒ èµ„æºå ç”¨è¾ƒå¤§ï¼ˆ~50-100MBï¼‰
- âŒ å¯åŠ¨æ—¶é—´è¾ƒé•¿ï¼ˆ1-3 ç§’ï¼‰
- âŒ éœ€è¦ç”¨æˆ·å®‰è£… Chrome

**ç¼“è§£æªæ–½ï¼š**
- ä½¿ç”¨æµè§ˆå™¨å®ä¾‹å¤ç”¨ï¼Œå‡å°‘å¯åŠ¨æ¬¡æ•°
- æä¾›å‹å¥½çš„é”™è¯¯æç¤ºï¼ŒæŒ‡å¯¼ç”¨æˆ·å®‰è£… Chrome
- è€ƒè™‘æœªæ¥æ·»åŠ  HTTP å¤‡é€‰æ–¹æ¡ˆï¼ˆä½œä¸ºé™çº§ç­–ç•¥ï¼‰

---

### å†³ç­– 2ï¼šä¸¤æ­¥å·¥å…·è®¾è®¡

**é€‰æ‹©ï¼š** åˆ†ç¦» `web_search` å’Œ `fetch_page_content` ä¸¤ä¸ªå·¥å…·

**ç†ç”±ï¼š**
- âœ… å¿«é€Ÿå“åº”ï¼šAgent å¯ä»¥å…ˆè·å–æœç´¢ç»“æœæ‘˜è¦ï¼Œå¿«é€Ÿåˆ¤æ–­æ˜¯å¦æœ‰ä»·å€¼
- âœ… Token æ•ˆç‡ï¼šåªåœ¨éœ€è¦æ—¶æ‰æŠ“å–è¯¦ç»†å†…å®¹ï¼Œå‡å°‘ä¸å¿…è¦çš„ token æ¶ˆè€—
- âœ… çµæ´»æ€§ï¼šAgent å¯ä»¥æ ¹æ®æœç´¢ç»“æœé€‰æ‹©æ€§æŠ“å–éƒ¨åˆ†é¡µé¢
- âœ… å¯æµ‹è¯•æ€§ï¼šä¸¤ä¸ªå·¥å…·å¯ä»¥ç‹¬ç«‹æµ‹è¯•

**æƒè¡¡ï¼š**
- Agent éœ€è¦ä¸¤æ¬¡è°ƒç”¨æ‰èƒ½è·å–å®Œæ•´ä¿¡æ¯

**æ¥å£è®¾è®¡ï¼š**
```go
// Tool 1: å¿«é€Ÿæœç´¢
type WebSearchParams struct {
    Query string `json:"query"`
}

type WebSearchResponse struct {
    Query   string             `json:"query"`
    Results []SearchResultItem `json:"results"`  // å›ºå®š 10 æ¡
}

// Tool 2: è¯¦ç»†æŠ“å–
type FetchPageParams struct {
    URL       string `json:"url"`
    MaxLength int    `json:"max_length,omitempty"`  // å¯é€‰ï¼Œé»˜è®¤ 5000
}

type FetchPageResponse struct {
    URL         string `json:"url"`
    Title       string `json:"title"`
    Content     string `json:"content"`
    HasMore     bool   `json:"has_more"`
    TotalLength int    `json:"total_length"`
}
```

---

### å†³ç­– 3ï¼šæ¥å£æŠ½è±¡ç­–ç•¥

**é€‰æ‹©ï¼š** å®šä¹‰ä¸‰ä¸ªæ ¸å¿ƒæ¥å£ï¼ˆ`Browser`ã€`SearchEngine`ã€`Extractor`ï¼‰

**ç†ç”±ï¼š**
- âœ… **å¯æ‰©å±•æ€§**ï¼šæœªæ¥æ·»åŠ æ–°çš„æœç´¢å¼•æ“æˆ–æå–å™¨æ— éœ€ä¿®æ”¹å·¥å…·å±‚
- âœ… **å¯æµ‹è¯•æ€§**ï¼šå¯ä»¥è½»æ¾ mock ä¾èµ–è¿›è¡Œå•å…ƒæµ‹è¯•
- âœ… **å¯ç»´æŠ¤æ€§**ï¼šå…³æ³¨ç‚¹åˆ†ç¦»ï¼Œæ¯ä¸ªç»„ä»¶èŒè´£å•ä¸€

**æ¥å£å®šä¹‰ï¼š**

```go
// Browser: æµè§ˆå™¨æŠ½è±¡å±‚
type Browser interface {
    GetPageHTML(url string) (string, error)
    GetPageText(url string) (string, error)
    Run(tasks ...chromedp.Action) error
    Close() error
}

// SearchEngine: æœç´¢å¼•æ“æŠ½è±¡
type SearchEngine interface {
    Search(query string, numResults int) ([]SearchResultItem, error)
}

// Extractor: å†…å®¹æå–å™¨æŠ½è±¡
type Extractor interface {
    Extract(html string) (title, content string, err error)
}
```

**å®ç°å±‚æ¬¡ï¼š**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Tools Layer                 â”‚
â”‚  (web_search, fetch_page_content)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Interface Layer             â”‚
â”‚  (SearchEngine, Extractor, Browser) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
       â–¼                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Google   â”‚      â”‚ Basic    â”‚
â”‚ Search   â”‚      â”‚ Extractorâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚chromedp  â”‚
         â”‚ Browser  â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### å†³ç­– 4ï¼šé”™è¯¯å¤„ç†ç­–ç•¥

**é€‰æ‹©ï¼š** æ˜ç¡®çš„é”™è¯¯åˆ†ç±» + æœ‰é™çš„æ™ºèƒ½é‡è¯•

**é”™è¯¯åˆ†ç±»ï¼š**

| é”™è¯¯ç±»å‹ | å¤„ç†ç­–ç•¥ | ç¤ºä¾‹ |
|---------|---------|------|
| **å‚æ•°é”™è¯¯** | ç«‹å³è¿”å›ï¼Œä¸é‡è¯• | ç©º queryã€æ— æ•ˆ URL |
| **æ°¸ä¹…é”™è¯¯** | ç«‹å³è¿”å›ï¼Œä¸é‡è¯• | 404ã€Chrome æœªå®‰è£… |
| **ä¸´æ—¶é”™è¯¯** | é‡è¯• 2 æ¬¡ï¼Œé—´éš” 1 ç§’ | ç½‘ç»œè¶…æ—¶ã€5xx |
| **åçˆ¬è™«** | ç«‹å³è¿”å›ï¼Œæç¤ºç”¨æˆ· | CAPTCHAã€IP å°ç¦ |

**å®ç°ï¼š**
```go
func isPermanentError(err error) bool {
    return strings.Contains(err.Error(), "404") ||
           strings.Contains(err.Error(), "Chrome not found") ||
           strings.Contains(err.Error(), "CAPTCHA")
}

func isTemporaryError(err error) bool {
    return net.ErrTimeout == err ||
           strings.Contains(err.Error(), "5")
}

func isAntiBotError(err error) bool {
    return strings.Contains(err.Error(), "CAPTCHA") ||
           strings.Contains(err.Error(), "blocked")
}
```

---

### å†³ç­– 5ï¼šå†…å®¹æå–ç­–ç•¥

**é€‰æ‹©ï¼š** åŸºç¡€å¯å‘å¼è§„åˆ™ + ä¿ç•™æ‰©å±•ç©ºé—´

**Phase 1 å®ç°ï¼š**
- ç§»é™¤ `<script>`ã€`<style>`ã€`<nav>`ã€`<header>`ã€`<footer>`
- æå– `<title>` æ ‡ç­¾
- æå– `<body>` çš„æ–‡æœ¬å†…å®¹
- ä½¿ç”¨æ¢è¡Œç¬¦åˆ†éš”æ®µè½

**ä¸å®ç°ï¼ˆPhase 2ï¼‰ï¼š**
- Readability é£æ ¼çš„å¤æ‚ç®—æ³•
- æœºå™¨å­¦ä¹ æ¨¡å‹
- ç½‘ç«™ç‰¹å®šçš„è§„åˆ™

**ç†ç”±ï¼š**
- âœ… ç®€å•å¯é ï¼Œæ˜“äºè°ƒè¯•
- âœ… è¦†ç›–å¤§éƒ¨åˆ†åœºæ™¯
- âœ… é¢„ç•™æ¥å£æ‰©å±•ç©ºé—´

**å®ç°ç¤ºä¾‹ï¼š**
```go
type BasicExtractor struct{}

func (e *BasicExtractor) Extract(html string) (title, content string, err error) {
    doc, err := html.Parse(strings.NewReader(html))
    if err != nil {
        return "", "", err
    }

    // æå–æ ‡é¢˜
    title = extractTitle(doc)

    // æå–å†…å®¹ï¼ˆç§»é™¤ä¸éœ€è¦çš„å…ƒç´ ï¼‰
    content = extractContent(doc)

    return title, content, nil
}
```

---

## é£é™© / æƒè¡¡

### é£é™© 1ï¼šChrome ä¾èµ–

**é£é™©æè¿°ï¼š**
ç”¨æˆ·ç³»ç»Ÿä¸­å¯èƒ½æ²¡æœ‰å®‰è£… Chrome æˆ– Chromiumï¼Œå¯¼è‡´åŠŸèƒ½æ— æ³•ä½¿ç”¨ã€‚

**å½±å“èŒƒå›´ï¼š**
- ç”¨æˆ·ä½“éªŒï¼šåŠŸèƒ½å®Œå…¨ä¸å¯ç”¨
- é”™è¯¯å¤„ç†ï¼šéœ€è¦åœ¨å¯åŠ¨æ—¶æ£€æµ‹å¹¶ç»™å‡ºå‹å¥½æç¤º

**ç¼“è§£æªæ–½ï¼š**
- åœ¨ `BrowserManager` åˆå§‹åŒ–æ—¶æ£€æµ‹ Chrome æ˜¯å¦å­˜åœ¨
- æä¾›æ¸…æ™°çš„é”™è¯¯ä¿¡æ¯ï¼ŒåŒ…å«å®‰è£…é“¾æ¥
- è€ƒè™‘æœªæ¥æ·»åŠ è‡ªåŠ¨ä¸‹è½½ Chromium çš„é€»è¾‘
- æ–‡æ¡£ä¸­æ˜ç¡®è¯´æ˜ä¾èµ–è¦æ±‚

---

### é£é™© 2ï¼šGoogle åçˆ¬è™«

**é£é™©æè¿°ï¼š**
Google å¯èƒ½æ£€æµ‹åˆ°çˆ¬è™«è¡Œä¸ºï¼Œè¿”å› CAPTCHA æˆ–å°ç¦ IPã€‚

**å½±å“èŒƒå›´ï¼š**
- åŠŸèƒ½å¯ç”¨æ€§ï¼šæœç´¢å¤±è´¥
- ç”¨æˆ·ä½“éªŒï¼šéœ€è¦äººå·¥å¤„ç†

**ç¼“è§£æªæ–½ï¼š**
- è®¾ç½®çœŸå®çš„ User-Agent
- é™åˆ¶è¯·æ±‚é¢‘ç‡ï¼ˆæ·»åŠ éšæœºå»¶è¿Ÿï¼‰
- ä¸æ— é™é‡è¯•ï¼ˆæœ€å¤š 2 æ¬¡ï¼‰
- æ£€æµ‹ CAPTCHA å¹¶è¿”å›æ˜ç¡®é”™è¯¯
- è€ƒè™‘ä½¿ç”¨ä»£ç† IPï¼ˆæœªæ¥ï¼‰

---

### é£é™© 3ï¼šæ€§èƒ½å’Œèµ„æºå ç”¨

**é£é™©æè¿°ï¼š**
Chrome å®ä¾‹å ç”¨è¾ƒå¤šå†…å­˜ï¼ˆ~50-100MBï¼‰ï¼Œå¯åŠ¨è¾ƒæ…¢ï¼ˆ1-3 ç§’ï¼‰ã€‚

**å½±å“èŒƒå›´ï¼š**
- å“åº”æ—¶é—´ï¼šé¦–æ¬¡æœç´¢è¾ƒæ…¢
- ç³»ç»Ÿèµ„æºï¼šå†…å­˜å ç”¨å¢åŠ 

**ç¼“è§£æªæ–½ï¼š**
- ä½¿ç”¨æµè§ˆå™¨å®ä¾‹å¤ç”¨ï¼ˆå•ä¾‹æ¨¡å¼ï¼‰
- ç¦ç”¨å›¾ç‰‡åŠ è½½ã€GPU åŠ é€Ÿ
- è®¾ç½®åˆç†çš„è¶…æ—¶æ—¶é—´
- åœ¨ä¼šè¯ç»“æŸæ—¶æ­£ç¡®é‡Šæ”¾èµ„æº

---

### é£é™© 4ï¼šå†…å®¹è´¨é‡ä¸ç¡®å®šæ€§

**é£é™©æè¿°ï¼š**
é€šç”¨æå–å™¨å¯èƒ½æ— æ³•å®Œç¾æå–æ‰€æœ‰ç½‘ç«™çš„å†…å®¹ã€‚

**å½±å“èŒƒå›´ï¼š**
- Agent ç†è§£ï¼šè·å–çš„å†…å®¹å¯èƒ½åŒ…å«æ— å…³ä¿¡æ¯
- Token æ¶ˆè€—ï¼šå¯èƒ½åŒ…å«å¹¿å‘Šã€å¯¼èˆªç­‰å™ªéŸ³

**ç¼“è§£æªæ–½ï¼š**
- å®ç°åŸºç¡€ä½†å¯é çš„æå–è§„åˆ™
- ä¿ç•™æ‰©å±•æ¥å£ï¼Œä¾¿äºæ·»åŠ ä¸“ç”¨æå–å™¨
- åœ¨ Phase 2 æ ¹æ®å®é™…æ•°æ®ä¼˜åŒ–
- è€ƒè™‘æ·»åŠ å†…å®¹è´¨é‡è¯„åˆ†ï¼ˆæœªæ¥ï¼‰

---

### é£é™© 5ï¼šå¹¶å‘å®‰å…¨æ€§

**é£é™©æè¿°ï¼š**
å¦‚æœ Agent å¹¶å‘è°ƒç”¨æœç´¢å·¥å…·ï¼Œå¯èƒ½å‡ºç°ç«æ€æ¡ä»¶ã€‚

**å½±å“èŒƒå›´ï¼š**
- ç¨‹åºç¨³å®šæ€§ï¼šå¯èƒ½å´©æºƒæˆ–æ­»é”
- æ•°æ®ä¸€è‡´æ€§ï¼šæµè§ˆå™¨çŠ¶æ€æ··ä¹±

**ç¼“è§£æªæ–½ï¼š**
- ä½¿ç”¨ `sync.Once` ç¡®ä¿æµè§ˆå™¨åªåˆå§‹åŒ–ä¸€æ¬¡
- ä½¿ç”¨äº’æ–¥é”ä¿æŠ¤å…±äº«çŠ¶æ€
- é™åˆ¶å¹¶å‘æ•°é‡ï¼ˆæœ€å¤š 2 ä¸ªå¹¶å‘è¯·æ±‚ï¼‰
- ä½¿ç”¨ context ç®¡ç†è¯·æ±‚ç”Ÿå‘½å‘¨æœŸ

---

## æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        MSA Tool System                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    Tool Registry                         â”‚   â”‚
â”‚  â”‚  (register.go - æ³¨å†Œæ‰€æœ‰å·¥å…·)                            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                           â”‚                                     â”‚
â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚          â–¼                â–¼                â–¼                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚ Stock Tools â”‚  â”‚Search Tools â”‚  â”‚   (future)  â”‚           â”‚
â”‚  â”‚             â”‚  â”‚             â”‚  â”‚             â”‚           â”‚
â”‚  â”‚ - Company   â”‚  â”‚ - web_searchâ”‚  â”‚             â”‚           â”‚
â”‚  â”‚ - CompanyK  â”‚  â”‚ - fetch_pageâ”‚  â”‚             â”‚           â”‚
â”‚  â”‚ - CompanyInfoâ”‚  â”‚             â”‚  â”‚             â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                          â”‚                                     â”‚
â”‚                          â–¼                                     â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚              â”‚     Search Engine         â”‚                    â”‚
â”‚              â”‚   (google.go)             â”‚                    â”‚
â”‚              â”‚                           â”‚                    â”‚
â”‚              â”‚  - Search()              â”‚                    â”‚
â”‚              â”‚  - parseSearchResults()  â”‚                    â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚                          â”‚                                     â”‚
â”‚                          â–¼                                     â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚              â”‚     Extractor             â”‚                    â”‚
â”‚              â”‚   (extractor.go)          â”‚                    â”‚
â”‚              â”‚                           â”‚                    â”‚
â”‚              â”‚  - Extract()              â”‚                    â”‚
â”‚              â”‚  - cleanHTML()            â”‚                    â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚                          â”‚                                     â”‚
â”‚                          â–¼                                     â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚              â”‚     Browser Manager       â”‚                    â”‚
â”‚              â”‚   (browser.go)            â”‚                    â”‚
â”‚              â”‚                           â”‚                    â”‚
â”‚              â”‚  - GetContext()           â”‚                    â”‚
â”‚              â”‚  - GetPageHTML()          â”‚                    â”‚
â”‚              â”‚  - Close()                â”‚                    â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚                          â”‚                                     â”‚
â”‚                          â–¼                                     â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚              â”‚     chromedp              â”‚                    â”‚
â”‚              â”‚   (å¤–éƒ¨ä¾èµ–)              â”‚                    â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## æ•°æ®æµ

### æœç´¢æµç¨‹

```
Agent â†’ web_search("ç‰¹æ–¯æ‹‰ æœ€æ–°è´¢æŠ¥")
   â†“
SearchTool.Search()
   â†“
GoogleSearchEngine.Search("ç‰¹æ–¯æ‹‰ æœ€æ–°è´¢æŠ¥", 10)
   â†“
BrowserManager.GetContext()
   â†“
chromedp.Navigate("https://www.google.com/search?q=...")
   â†“
chromedp.InnerHTML() â†’ è·å–æœç´¢ç»“æœ HTML
   â†“
parseSearchResults() â†’ è§£æå‡º 10 æ¡ç»“æœ
   â†“
è¿”å›ç»™ Agent:
{
  "query": "ç‰¹æ–¯æ‹‰ æœ€æ–°è´¢æŠ¥",
  "results": [
    {"title": "...", "url": "...", "snippet": "...", "source": "..."},
    ... (10 æ¡)
  ]
}
```

### æŠ“å–æµç¨‹

```
Agent â†’ fetch_page_content("https://example.com/article")
   â†“
FetcherTool.Fetch()
   â†“
BrowserManager.GetContext()
   â†“
chromedp.Navigate("https://example.com/article")
   â†“
chromedp.WaitVisible("body") â†’ ç­‰å¾…é¡µé¢åŠ è½½
   â†“
chromedp.InnerHTML() â†’ è·å–å®Œæ•´ HTML
   â†“
BasicExtractor.Extract(html)
   â†“
è¿”å›ç»™ Agent:
{
  "url": "https://example.com/article",
  "title": "æ–‡ç« æ ‡é¢˜",
  "content": "æå–çš„æ­£æ–‡å†…å®¹ï¼ˆæœ€å¤š 5000 å­—ç¬¦ï¼‰",
  "has_more": true,
  "total_length": 12000
}
```

---

## ç›®å½•ç»“æ„

```
pkg/logic/tools/search/
â”œâ”€â”€ search.go              # web_search å·¥å…·å®ç°
â”‚   â”œâ”€â”€ SearchTool ç»“æ„ä½“
â”‚   â”œâ”€â”€ GetToolInfo()
â”‚   â”œâ”€â”€ GetName()
â”‚   â”œâ”€â”€ GetDescription()
â”‚   â””â”€â”€ WebSearch() å‡½æ•°
â”‚
â”œâ”€â”€ fetcher.go             # fetch_page_content å·¥å…·å®ç°
â”‚   â”œâ”€â”€ FetcherTool ç»“æ„ä½“
â”‚   â”œâ”€â”€ GetToolInfo()
â”‚   â”œâ”€â”€ GetName()
â”‚   â”œâ”€â”€ GetDescription()
â”‚   â””â”€â”€ FetchPageContent() å‡½æ•°
â”‚
â”œâ”€â”€ browser.go             # æµè§ˆå™¨ç®¡ç†
â”‚   â”œâ”€â”€ Browser æ¥å£å®šä¹‰
â”‚   â”œâ”€â”€ BrowserManager ç»“æ„ä½“
â”‚   â”œâ”€â”€ NewBrowserManager()
â”‚   â”œâ”€â”€ GetContext()
â”‚   â”œâ”€â”€ GetPageHTML()
â”‚   â”œâ”€â”€ GetPageText()
â”‚   â””â”€â”€ Close()
â”‚
â”œâ”€â”€ google.go              # Google æœç´¢å¼•æ“
â”‚   â”œâ”€â”€ SearchEngine æ¥å£å®šä¹‰
â”‚   â”œâ”€â”€ GoogleSearchEngine ç»“æ„ä½“
â”‚   â”œâ”€â”€ NewGoogleSearchEngine()
â”‚   â”œâ”€â”€ Search()
â”‚   â””â”€â”€ parseSearchResults()
â”‚
â”œâ”€â”€ extractor.go           # å†…å®¹æå–å™¨
â”‚   â”œâ”€â”€ Extractor æ¥å£å®šä¹‰
â”‚   â”œâ”€â”€ BasicExtractor ç»“æ„ä½“
â”‚   â”œâ”€â”€ NewBasicExtractor()
â”‚   â”œâ”€â”€ Extract()
â”‚   â”œâ”€â”€ cleanHTML()
â”‚   â””â”€â”€ extractTitle()
â”‚
â””â”€â”€ models.go              # æ•°æ®ç»“æ„å®šä¹‰
    â”œâ”€â”€ WebSearchParams
    â”œâ”€â”€ WebSearchResponse
    â”œâ”€â”€ SearchResultItem
    â”œâ”€â”€ FetchPageParams
    â””â”€â”€ FetchPageResponse

pkg/logic/tools/register.go  (ä¿®æ”¹)
â”œâ”€â”€ æ–°å¢ SearchToolGroup å¸¸é‡
â””â”€â”€ æ³¨å†Œ search å·¥å…·ç»„

pkg/model/  (å¯èƒ½ä¿®æ”¹)
â””â”€â”€ æ–°å¢ SearchToolGroup å¸¸é‡
```

---

## ä¾èµ–ç®¡ç†

### Go ä¾èµ–

```go
require (
    github.com/chromedp/chromedp v0.x.x  // Chrome DevTools Protocol
    golang.org/x/net v0.x.x               // HTML è§£æã€å…¬å…±åç¼€åº“
)
```

### ç³»ç»Ÿä¾èµ–

- **Chrome æˆ– Chromium**ï¼šç‰ˆæœ¬ 80+
- **ç½‘ç»œè¿æ¥**ï¼šè®¿é—® Google å’Œç›®æ ‡ç½‘ç«™

---

## è¿ç§»è®¡åˆ’

### é˜¶æ®µ 1ï¼šå‡†å¤‡å·¥ä½œï¼ˆ1 å¤©ï¼‰

- [ ] æ·»åŠ  chromedp ä¾èµ–åˆ° `go.mod`
- [ ] åˆ›å»º `pkg/logic/tools/search/` ç›®å½•
- [ ] åœ¨ `pkg/model/` ä¸­æ·»åŠ  `SearchToolGroup` å¸¸é‡

### é˜¶æ®µ 2ï¼šåŸºç¡€è®¾æ–½ï¼ˆ2 å¤©ï¼‰

- [ ] å®ç° `BrowserManager`ï¼ˆbrowser.goï¼‰
  - [ ] å•ä¾‹æ¨¡å¼ç®¡ç†æµè§ˆå™¨å®ä¾‹
  - [ ] å¯åŠ¨å’Œå…³é—­é€»è¾‘
  - [ ] Chrome æ£€æµ‹å’Œé”™è¯¯å¤„ç†

- [ ] å®ç° `BasicExtractor`ï¼ˆextractor.goï¼‰
  - [ ] HTML æ¸…ç†é€»è¾‘
  - [ ] æ ‡é¢˜å’Œå†…å®¹æå–

- [ ] å®ç° `GoogleSearchEngine`ï¼ˆgoogle.goï¼‰
  - [ ] æœç´¢é€»è¾‘
  - [ ] ç»“æœè§£æ

### é˜¶æ®µ 3ï¼šå·¥å…·å®ç°ï¼ˆ2 å¤©ï¼‰

- [ ] å®ç° `web_search` å·¥å…·ï¼ˆsearch.goï¼‰
  - [ ] å®ç° `MsaTool` æ¥å£
  - [ ] é›†æˆ `GoogleSearchEngine`
  - [ ] æ·»åŠ æ¶ˆæ¯å¹¿æ’­

- [ ] å®ç° `fetch_page_content` å·¥å…·ï¼ˆfetcher.goï¼‰
  - [ ] å®ç° `MsaTool` æ¥å£
  - [ ] é›†æˆ `BrowserManager` å’Œ `Extractor`
  - [ ] æ·»åŠ æ¶ˆæ¯å¹¿æ’­

- [ ] æ³¨å†Œå·¥å…·åˆ°ç³»ç»Ÿï¼ˆregister.goï¼‰

### é˜¶æ®µ 4ï¼šæµ‹è¯•å’Œä¼˜åŒ–ï¼ˆ1 å¤©ï¼‰

- [ ] å•å…ƒæµ‹è¯•
  - [ ] æµ‹è¯• `BasicExtractor`
  - [ ] æµ‹è¯• `GoogleSearchEngine`
  - [ ] æµ‹è¯•å·¥å…·æ¥å£

- [ ] é›†æˆæµ‹è¯•
  - [ ] ç«¯åˆ°ç«¯æµ‹è¯•æœç´¢æµç¨‹
  - [ ] ç«¯åˆ°ç«¯æµ‹è¯•æŠ“å–æµç¨‹

- [ ] æ€§èƒ½æµ‹è¯•
  - [ ] æµ‹é‡é¦–æ¬¡æœç´¢æ—¶é—´
  - [ ] æµ‹é‡å†…å­˜å ç”¨
  - [ ] ä¼˜åŒ–ç“¶é¢ˆ

### é˜¶æ®µ 5ï¼šæ–‡æ¡£å’Œå‘å¸ƒï¼ˆ1 å¤©ï¼‰

- [ ] æ›´æ–° README.md
- [ ] æ·»åŠ ä½¿ç”¨ç¤ºä¾‹
- [ ] æ·»åŠ ä¾èµ–è¯´æ˜ï¼ˆChrome è¦æ±‚ï¼‰
- [ ] å‘å¸ƒæ–°ç‰ˆæœ¬

### å›æ»šç­–ç•¥

å¦‚æœå®ç°è¿‡ç¨‹ä¸­é‡åˆ°æ— æ³•è§£å†³çš„é—®é¢˜ï¼š

1. **ç§»é™¤å·¥å…·æ³¨å†Œ**ï¼šä» `register.go` ä¸­ç§»é™¤ search å·¥å…·çš„æ³¨å†Œ
2. **åˆ é™¤ç›®å½•**ï¼šåˆ é™¤ `pkg/logic/tools/search/` ç›®å½•
3. **æ¸…ç†ä¾èµ–**ï¼šä» `go.mod` ä¸­ç§»é™¤ chromedp
4. **å›æ»šä»£ç **ï¼šä½¿ç”¨ `git revert` æ¢å¤åˆ°å®ç°å‰çš„çŠ¶æ€

---

## æµ‹è¯•ç­–ç•¥

### å•å…ƒæµ‹è¯•

```go
// BasicExtractor æµ‹è¯•
func TestBasicExtractor_Extract(t *testing.T) {
    extractor := NewBasicExtractor()

    tests := []struct {
        name     string
        html     string
        wantTitle string
        wantContent string
    }{
        {
            name: "ç®€å•é¡µé¢",
            html: `<html><head><title>æµ‹è¯•</title></head><body>å†…å®¹</body></html>`,
            wantTitle: "æµ‹è¯•",
            wantContent: "å†…å®¹",
        },
        // æ›´å¤šæµ‹è¯•ç”¨ä¾‹...
    }

    for _, tt := range tests {
        t.Run(tt.name, func(t *testing.T) {
            title, content, err := extractor.Extract(tt.html)
            assert.NoError(t, err)
            assert.Equal(t, tt.wantTitle, title)
            assert.Equal(t, tt.wantContent, content)
        })
    }
}
```

### é›†æˆæµ‹è¯•

```go
func TestWebSearch_EndToEnd(t *testing.T) {
    if testing.Short() {
        t.Skip("è·³è¿‡é›†æˆæµ‹è¯•")
    }

    tool := &SearchTool{
        engine: NewGoogleSearchEngine(NewBrowserManager()),
    }

    result, err := WebSearch(context.Background(), &WebSearchParams{
        Query: "Golang",
    })

    assert.NoError(t, err)
    assert.Contains(t, result, "results")
}
```

---

## æ€§èƒ½æŒ‡æ ‡

### ç›®æ ‡æ€§èƒ½

| æ“ä½œ | ç›®æ ‡æ—¶é—´ | å®é™…æ—¶é—´ï¼ˆé¢„ä¼°ï¼‰ |
|-----|---------|----------------|
| é¦–æ¬¡æœç´¢ | < 5 ç§’ | 3-4 ç§’ï¼ˆå«å¯åŠ¨ï¼‰ |
| åç»­æœç´¢ | < 2 ç§’ | 1-2 ç§’ï¼ˆå¤ç”¨å®ä¾‹ï¼‰ |
| é¡µé¢æŠ“å– | < 8 ç§’ | 3-6 ç§’ |
| å†…å­˜å ç”¨ | < 100MB | 50-80MB |

### ç›‘æ§æŒ‡æ ‡

- æœç´¢æˆåŠŸç‡ï¼ˆéé”™è¯¯è¿”å›çš„æ¯”ä¾‹ï¼‰
- å¹³å‡å“åº”æ—¶é—´
- æµè§ˆå™¨å´©æºƒæ¬¡æ•°
- CAPTCHA è§¦å‘æ¬¡æ•°

---

## æœªæ¥æ‰©å±•

### Phase 2 å¯èƒ½çš„ä¼˜åŒ–

1. **è´¢ç»æ–°é—»ä¸“ç”¨æå–å™¨**
   - è¯†åˆ«å‘å¸ƒæ—¶é—´ã€è‚¡ç¥¨ä»£ç ã€å…³é”®è´¢åŠ¡æ•°æ®
   - å»é™¤å¹¿å‘Šå’Œæ— å…³å†…å®¹

2. **å¤šæœç´¢å¼•æ“æ”¯æŒ**
   - æ·»åŠ  Bingã€ç™¾åº¦ç­‰å¼•æ“
   - æ ¹æ®æŸ¥è¯¢è¯­è¨€é€‰æ‹©åˆé€‚çš„å¼•æ“

3. **æœç´¢ç»“æœé‡æ’åº**
   - åŸºäºæ—¶é—´é‡æ–°æ’åº
   - åŸºäºæ¥æºæƒå¨æ€§åŠ æƒ

4. **ç»“æœç¼“å­˜**
   - ç¼“å­˜å¸¸è§æŸ¥è¯¢
   - å‡å°‘é‡å¤è¯·æ±‚

5. **HTTP å¤‡é€‰æ–¹æ¡ˆ**
   - å¯¹äºä¸éœ€è¦ JS æ¸²æŸ“çš„ç®€å•ç½‘ç«™
   - ä½¿ç”¨ HTTP å®¢æˆ·ç«¯æ›´å¿«

---

## æ€»ç»“

æœ¬è®¾è®¡éµå¾ªä»¥ä¸‹åŸåˆ™ï¼š

1. **ç®€å•æ€§ä¼˜å…ˆ**ï¼šPhase 1 å®ç°æ ¸å¿ƒåŠŸèƒ½ï¼Œä¿æŒä»£ç ç®€æ´
2. **å¯æ‰©å±•æ€§**ï¼šé€šè¿‡æ¥å£æŠ½è±¡é¢„ç•™æ‰©å±•ç©ºé—´
3. **ç”¨æˆ·ä½“éªŒ**ï¼šæä¾›å‹å¥½çš„é”™è¯¯æç¤ºå’Œæ¸…æ™°çš„åé¦ˆ
4. **æ€§èƒ½å¹³è¡¡**ï¼šåœ¨åŠŸèƒ½å®Œæ•´æ€§å’Œèµ„æºå ç”¨ä¹‹é—´æ‰¾åˆ°å¹³è¡¡
5. **æ¸è¿›å¼ä¼˜åŒ–**ï¼šPhase 2 æ ¹æ®å®é™…æ•°æ®å’Œä½¿ç”¨åé¦ˆè¿›è¡Œä¼˜åŒ–

é€šè¿‡è¿™ä¸ªè®¾è®¡ï¼ŒMSA å°†å…·å¤‡è·å–å®æ—¶ç½‘ç»œä¿¡æ¯çš„èƒ½åŠ›ï¼Œå¤§å¤§å¢å¼ºè‚¡ç¥¨åˆ†æçš„å‡†ç¡®æ€§å’Œæ—¶æ•ˆæ€§ã€‚
